"use strict";exports.id=447,exports.ids=[447],exports.modules={76447:(e,t,l)=>{l.r(t),l.d(t,{default:()=>b});var s=l(10326),a=l(17577),i=l(98998),n=l(54340),r=l(10211),o=l(41245),c=l(17779),d=l(20117),u=l(55227);let x="flow_admin_draft_v1",m="https://www.simonanicolaescu.ro/wp-content/uploads/2021/10/1-2-trecerea-peste-obstacole.mp3",p="/audio/1-2-trecerea-peste-obstacole.mp3";function g(){let e=o.Z.useState(e=>e.flows),[t,l]=((0,a.useMemo)(()=>(function(){try{let e=localStorage.getItem(x);if(!e)return null;let t=JSON.parse(e);if(!t||1!==t.version||!Array.isArray(t.flows))return null;let l=new Set(t.flows.map(e=>"string"==typeof e?.id?e.id:null).filter(Boolean)),s=new Set(c.Y.map(e=>e.id)),a=0;for(let e of Array.from(l))s.has(e)&&(a+=1);let i=Math.max(l.size,s.size),n=0===i?1:a/i;if(0===a||n<.5){try{localStorage.removeItem(x)}catch{}return null}return t.flows.map(e=>({...e,practices:Array.isArray(e.practices)?e.practices.map(e=>({...e,audioUrl:e?.audioUrl?.ro===m||e?.audioUrl?.en===m?{ro:p,en:p}:e.audioUrl})):e.practices}))}catch{return null}})()??e,[e]),(0,a.useState)(!1)),[s,i]=(0,a.useState)("");return null}function h(e){return e.map((e,t)=>({...e,position:t+1}))}function f({isOpen:e,practice:t,onClose:l,onSave:i}){let[n,r]=(0,a.useState)(t);return e&&n?s.jsx("div",{className:"fixed inset-0 z-[9999] bg-black/60 flex items-center justify-center p-4",children:(0,s.jsxs)("div",{className:"w-full max-w-2xl rounded-2xl bg-white p-5",children:[(0,s.jsxs)("div",{className:"flex items-center justify-between gap-3",children:[s.jsx("h2",{className:"text-xl font-bold text-gray-900",children:"Edit practice"}),s.jsx("button",{className:"text-gray-500 hover:text-gray-700",onClick:l,type:"button",children:"Close"})]}),(0,s.jsxs)("div",{className:"mt-4 grid grid-cols-1 md:grid-cols-2 gap-3",children:[(0,s.jsxs)("div",{children:[s.jsx("label",{className:"text-sm font-semibold text-gray-700",children:"Practice ID"}),s.jsx("input",{className:"mt-1 w-full rounded-lg border px-3 py-2 text-sm",value:n.id,onChange:e=>r({...n,id:e.target.value})})]}),(0,s.jsxs)("div",{children:[s.jsx("label",{className:"text-sm font-semibold text-gray-700",children:"Audio URL (RO)"}),s.jsx("input",{className:"mt-1 w-full rounded-lg border px-3 py-2 text-sm",value:n.audioUrl.ro,onChange:e=>r({...n,audioUrl:{...n.audioUrl,ro:e.target.value}})})]}),(0,s.jsxs)("div",{children:[s.jsx("label",{className:"text-sm font-semibold text-gray-700",children:"Title (RO)"}),s.jsx("input",{className:"mt-1 w-full rounded-lg border px-3 py-2 text-sm",value:n.title.ro,onChange:e=>r({...n,title:{...n.title,ro:e.target.value}})})]}),(0,s.jsxs)("div",{children:[s.jsx("label",{className:"text-sm font-semibold text-gray-700",children:"Title (EN)"}),s.jsx("input",{className:"mt-1 w-full rounded-lg border px-3 py-2 text-sm",value:n.title.en,onChange:e=>r({...n,title:{...n.title,en:e.target.value}})})]}),(0,s.jsxs)("div",{children:[s.jsx("label",{className:"text-sm font-semibold text-gray-700",children:"Name (RO)"}),s.jsx("input",{className:"mt-1 w-full rounded-lg border px-3 py-2 text-sm",value:n.name.ro,onChange:e=>r({...n,name:{...n.name,ro:e.target.value}})})]}),(0,s.jsxs)("div",{children:[s.jsx("label",{className:"text-sm font-semibold text-gray-700",children:"Name (EN)"}),s.jsx("input",{className:"mt-1 w-full rounded-lg border px-3 py-2 text-sm",value:n.name.en,onChange:e=>r({...n,name:{...n.name,en:e.target.value}})})]}),(0,s.jsxs)("div",{className:"md:col-span-2",children:[s.jsx("label",{className:"text-sm font-semibold text-gray-700",children:"Description (RO)"}),s.jsx("textarea",{className:"mt-1 w-full rounded-lg border px-3 py-2 text-sm",value:n.description.ro,onChange:e=>r({...n,description:{...n.description,ro:e.target.value}}),rows:4})]}),(0,s.jsxs)("div",{className:"md:col-span-2",children:[s.jsx("label",{className:"text-sm font-semibold text-gray-700",children:"Description (EN)"}),s.jsx("textarea",{className:"mt-1 w-full rounded-lg border px-3 py-2 text-sm",value:n.description.en,onChange:e=>r({...n,description:{...n.description,en:e.target.value}}),rows:4})]}),(0,s.jsxs)("div",{className:"md:col-span-2",children:[s.jsx("label",{className:"text-sm font-semibold text-gray-700",children:"Audio URL (EN)"}),s.jsx("input",{className:"mt-1 w-full rounded-lg border px-3 py-2 text-sm",value:n.audioUrl.en,onChange:e=>r({...n,audioUrl:{...n.audioUrl,en:e.target.value}})})]})]}),(0,s.jsxs)("div",{className:"mt-5 flex justify-end gap-2",children:[s.jsx("button",{className:"rounded-lg border px-4 py-2 text-sm",onClick:l,type:"button",children:"Cancel"}),s.jsx("button",{className:"rounded-lg bg-purple-600 px-4 py-2 text-sm font-semibold text-white hover:bg-purple-700",onClick:()=>i(n),type:"button",children:"Save"})]})]})}):null}function j({practice:e,idx:t,flowId:l,flowIndex:a,lang:r,onMove:o,onEdit:u}){let x=(0,d.T)(l,e.id,a,t);return(0,s.jsxs)(i.Ie,{className:"no-bg-color py-4 text-white",routerLink:`/flows/${l}/${e.id}`,children:[s.jsx(i.gu,{className:"text-white text-3xl",icon:x?n.S38:n.hkI}),(0,s.jsxs)(i.Q$,{className:"pl-5 text-white text-lg",children:[(0,c.t)(e.name,r),!x&&s.jsx(i.yp,{color:"warning",className:"ml-2",children:"Premium"})]}),(0,s.jsxs)("div",{className:"flex items-center gap-1",children:[s.jsx("button",{type:"button",className:"rounded-lg bg-white/10 hover:bg-white/20 px-2 py-1 text-white text-sm",onClick:e=>{e.preventDefault(),e.stopPropagation(),o(t,-1)},title:"Move up",children:s.jsx(i.gu,{icon:n.Edm})}),s.jsx("button",{type:"button",className:"rounded-lg bg-white/10 hover:bg-white/20 px-2 py-1 text-white text-sm",onClick:e=>{e.preventDefault(),e.stopPropagation(),o(t,1)},title:"Move down",children:s.jsx(i.gu,{icon:n.o9Y})}),s.jsx("button",{type:"button",className:"rounded-lg bg-white/10 hover:bg-white/20 px-2 py-1 text-white text-sm",onClick:t=>{t.preventDefault(),t.stopPropagation(),u(e.id)},title:"Edit",children:s.jsx(i.gu,{icon:n.mjL})})]})]},e.id)}function b({flowId:e,flowIndex:t,lang:l}){(0,r.k6)();let c=o.Z.useState(e=>e.isSuperAdmin)&&(0,u.h)(),d=o.Z.useState(e=>e.flows),m=d.find(t=>t.id===e)??null,p=(0,a.useMemo)(()=>h(m?.practices??[]),[m?.practices]),b=e=>{o.Z.update(t=>{t.flows=e}),function(e){try{localStorage.setItem(x,JSON.stringify({version:1,flows:e}))}catch{}}(e)},v=e=>{m&&b(d.map(t=>t.id===m.id?{...t,practices:h(e),totalPractices:e.length}:t))},N=(e,t)=>{let l=[...p],s=e+t;if(s<0||s>=l.length)return;let a=l[e];l[e]=l[s],l[s]=a,v(l)},[w,y]=(0,a.useState)(null),S=p.find(e=>e.id===w)??null;return c&&m?(0,s.jsxs)("div",{className:"no-bg-color",children:[(0,s.jsxs)("div",{className:"flex items-center justify-between px-2 py-2",children:[s.jsx("div",{className:"text-xs text-white/70",children:"Admin draft mode (local only)."}),(0,s.jsxs)("div",{className:"flex items-center gap-2",children:[s.jsx(g,{}),(0,s.jsxs)(i.YG,{onClick:()=>{var e;v([...p,(e=p.length+1,{id:`NewPractice-${Date.now()}`,position:e,title:{ro:"New Practice",en:"New Practice"},name:{ro:"New Practice",en:"New Practice"},intro:{ro:"",en:""},description:{ro:"",en:""},audioUrl:{ro:"",en:""},finished:!1,lastPositionSec:0})])},color:"light",size:"small",children:[s.jsx(i.gu,{icon:n.s6O,slot:"start"}),"New practice"]})]})]}),p.map((a,i)=>s.jsx(j,{practice:a,idx:i,flowId:e,flowIndex:t,lang:l,onMove:N,onEdit:y},a.id)),s.jsx(f,{isOpen:!!w,practice:S,onClose:()=>y(null),onSave:e=>{v(p.map(t=>t.id===w?{...e,finished:t.finished,lastPositionSec:t.lastPositionSec}:t)),y(null)}})]}):null}}};